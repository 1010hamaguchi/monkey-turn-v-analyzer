# スマスロ モンキーターン V 設定判別ツール 要件定義書（MVP-Rev2）

- **版数**: v1.1  
- **作成日**: 2025-09-06  
- **作成者**: hamaguchi  
- **対象読者**: hamaguchi

---

## 1. 目的・背景
- 遊技中/実戦後の入力データ（小役回数、初当たり、ゲーム数 など）から**設定推定**を提示する公開Webアプリを提供する。
- 利用者の意思決定（続行/撤退）の参考情報を、**わかりやすい可視化**と**根拠の明示**で支援する。
- 将来、他機種へ水平展開できる**共通アルゴリズム**・**機種パラメータ管理**を前提とする。
- 責任ある利用を促すため、18歳未満の利用禁止、依存症対策窓口案内、成果の非保証を明記する。

## 2. スコープ（対象／非対象）
### 2.1 対象（MVP）
- 対象機種：スマスロ モンキーターン V
- 入力：手動カウント（＋/−）、累積値入力
- 出力：設定1〜6の推定結果（割合表示）、寄与指標の内訳、サンプル不足警告
- 可視化：推定設定の割合を数値またはバー表示で提示（円グラフ不要）
- 共有：不要
- 管理：機種パラメータ（理論値・重み・閾値）のRead/Update
- 公開：スマホ向けレスポンシブWeb（ログイン不要で基本利用可）

### 2.2 非対象（MVP外）
- ホール実データの自動収集/クローリング、画像解析による自動カウント
- 決済/課金、会員ランク、ネイティブアプリ（iOS/Android）
- 個別ホール毎の挙動推定や独自の出玉予測モデル
- CSVインポート、パーマリンク生成、画像共有機能
- 高度な可視化（円グラフ、ドーナツチャート等）
- 利用ログの収集・分析（MVPでは不要、エラーログのみ）

## 3. 用語定義
- **設定**：スロット機における内部設定（一般的には1〜6であるが、機種ごとに異なる）。
- **入力データ**：小役成功回数/試行回数、AT/CZ初当たり回数、通常時ゲーム数など、推定に用いるデータ。
- **機種パラメータ**：機種ごとの判別指標と、設定別の理論値/分布/重み/閾値。
- **設定推定**：入力データを反映した各設定の確率。
- **セッション**：1回の遊技やデータ入力の単位。

## 4. 前提条件・制約・想定稼働条件
- **法令/倫理**：18歳未満の利用禁止、依存症対策窓口の常設リンク、結果の非保証・免責を明示。
- **権利配慮**：メーカー画像/ロゴの無断使用は不可。一般名詞と自作UIで表現。
- **データ**：PIIは収集しない。エラーログのみ保持（期間制限は任意、簡易運用）。
- **環境**：クラウドコード（サーバーレス）でAPIを提供。CDN配信とキャッシュを活用。
- **対応ブラウザ**：最新のChrome/Edge/Safari/Firefox、主要スマホブラウザ。
- **性能目標（MVP）**：主要API P95 < 200ms、初回TTFB < 300ms（100同時接続規模）。
- **可用性目標**：月間稼働率99.9%（ベストエフォート、SLAは将来検討）。
- **言語**：UIは日本語（将来多言語化を検討）。

## 5. 想定ユーザー
- **一般ユーザー**：実戦中/実戦後に手元データで素早く判別したい。
- **運営/管理者**：機種パラメータ・告知の更新、品質監視、利用規約の管理を行う。

## 6. 利用シナリオ／ユースケース
### UC-01：実戦中のリアルタイム判別
**アクター**：一般ユーザー  
**トリガー**：遊技中に小役や初当たりを都度入力したい。  
**基本フロー**：
1. トップで「モンキーターン V」を選択。
2. 入力画面で＋/−やプルダウンで観測値を追加。
3. 結果パネルが即時更新され、各設定の確率（割合）が数値またはバーで表示。
4. サンプル不足時は必要試行数の目安を提示。  
**成功条件**：3タップ以内に最新の確率が更新され、視認性が高い。

### UC-02：管理者による機種パラメータ更新
**アクター**：運営/管理者  
**トリガー**：検証により理論値や重みを更新したい。  
**基本フロー**：
1. 管理画面にログイン。
2. 対象機種・指標を選択し、値/重み/閾値を編集。
3. 下書き保存→プレビュー→公開。
4. 公開後、60秒以内に新パラメータが反映。  
**成功条件**：更新が即時性と整合性を保って反映、監査ログが残る。

### UC-03：入力エラー/サンプル不足時の誘導
**アクター**：一般ユーザー  
**トリガー**：極端値・矛盾した入力。  
**基本フロー**：
1. 入力検証でエラー箇所を特定・明示。
2. サンプル不足は「判別困難」バッジ＋補足ガイドを表示。  
**成功条件**：原因と対処が1画面で理解でき、離脱を防ぐ。  

### 7.1 機能一覧
**優先度記号**：M=Must（MVP必須） / S=Should（MVP内で余力があれば） / C=Could（将来拡張）
| ID | 機能 | 内容 | 優先度 |
|---|---|---|---|
| F-01 | 機種選択 | トップで「スマスロ モンキーターン V」を選択 | M |
| F-02 | 入力（手動カウント） | ＋/−ボタンで小役・当選などを増減 | M |
| F-03 | 入力（累積値） | 累積トータル値を直接入力（数値） | M |
| F-04 | 入力検証 | 型・範囲・矛盾チェック、エラーメッセージ表示 | M |
| F-05 | 設定推定 | 入力直後に各設定の確率（割合）を算出 | M |
| F-06 | 可視化 | 設定1〜6の割合を数値/バーで表示（円グラフなし） | M |
| F-07 | サンプル不足判定 | 必要試行数の目安と「判別困難」バッジ | M |
| F-08 | 寄与内訳の表示 | 主要指標の寄与/乖離の簡易表示 | M |
| F-09 | 管理ログイン | 管理者認証（BASIC/ID・PW） | M |
| F-10 | 機種パラメータ参照 | 理論値・重み・閾値を読み出してFEに配信 | M |
| F-10b | 判別カテゴリ管理（機種別） | 機種ごとに「設定判別に利用する項目」を分類（例：小役/直撃/CZ・チャレンジ/AT初当たり/モード・移行/示唆）。名称・順序・可視/非表示、カテゴリ配下の指標の紐付けをR/Uで管理（初期登録はシード）。 | M |
| F-11 | 機種パラメータ更新 | 管理画面から値/重み/閾値を更新（Read/Update） | M |
| F-12 | 告知/免責の表示 | 静的テキストとして画面表示 | M |
| F-13 | レート制限 | 一般APIに 60 req/min/IP の上限を適用（DoS簡易対策） | M |

**設定判別要素**  
- AT初当たり：AT初当たり確率 、入力データは「通常時の総ゲーム数」「総AT初当たり回数」
- AT直撃：AT直撃確率（契機役ごとで入力）、入力データは、「通常時の総ゲーム数」「AT直撃回数」「契機役」
- 小役・5枚役：5枚役出現率、入力データは、「総ゲーム数」「総5枚役の回数」
- 黒メダル：黒メダル出現率、入力データは、「総AT終了回数」「黒メダル出現回数」
- 即優出：即優出確率、入力データは、「総AT終了回数」「総即優出回数」

### 7.2 画面要件（画面一覧・遷移図）
- **G-01 トップ**：機種カード（モンキーターンV）、免責/注意喚起テキスト  
- **G-02 入力＋結果（単一画面）**：  
  - 左：入力（手動カウント、累積値）、検証エラー表示  
  - 右：設定1〜6の割合（数値/バー）、サンプル不足、寄与内訳  
- **G-03 管理ログイン**：ID/パスワード（BASIC）  
- **G-04 管理：機種パラメータ/カテゴリ**：カテゴリ一覧→編集（名称/順序/可視）→指標紐付け→反映（R/U）